apiVersion: apiextensions.k8s.io/v1beta1
kind: CustomResourceDefinition
metadata:
  name: pipelinedeployments.algo.run
spec:
  group: algo.run
  names:
    kind: PipelineDeployment
    listKind: PipelineDeploymentList
    plural: pipelinedeployments
    singular: pipelinedeployment
  scope: Namespaced
  subresources:
    status: {}
  validation:
    openAPIV3Schema:
      description: PipelineDeployment is the Schema for the PipelineDeployments API
      properties:
        apiVersion:
          description: 'APIVersion defines the versioned schema of this representation
            of an object. Servers should convert recognized schemas to the latest
            internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources'
          type: string
        kind:
          description: 'Kind is a string value representing the REST resource this
            object represents. Servers may infer this from the endpoint the client
            submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds'
          type: string
        metadata:
          type: object
        spec:
          description: PipelineDeploymentSpecV1beta1 struct for PipelineDeploymentSpecV1beta1
          properties:
            algos:
              items:
                description: AlgoConfig struct for AlgoConfig
                properties:
                  algoIndex:
                    format: int32
                    type: integer
                  algoName:
                    type: string
                  algoOwnerUserName:
                    type: string
                  algoParams:
                    items:
                      description: AlgoParamModel struct for AlgoParamModel
                      properties:
                        dataType:
                          description: DataTypeModel struct for DataTypeModel
                          properties:
                            mask:
                              type: string
                            name:
                              description: DataTypes the model 'DataTypes'
                              type: string
                            precision:
                              format: int32
                              type: integer
                            regex:
                              type: string
                            scale:
                              format: int32
                              type: integer
                          required:
                          - name
                          type: object
                        description:
                          type: string
                        name:
                          type: string
                        options:
                          items:
                            description: DataTypeOptionModel struct for DataTypeOptionModel
                            properties:
                              name:
                                type: string
                            type: object
                          type: array
                        required:
                          type: boolean
                        sortOrder:
                          format: int32
                          type: integer
                        value:
                          type: string
                      required:
                      - name
                      type: object
                    type: array
                  algoRunnerImage:
                    type: string
                  algoRunnerImageTag:
                    type: string
                  algoVersionTag:
                    type: string
                  applied:
                    type: boolean
                  configMounts:
                    items:
                      description: ConfigMountModel struct for ConfigMountModel
                      properties:
                        data:
                          type: string
                        mountPath:
                          type: string
                        name:
                          type: string
                      required:
                      - data
                      - mountPath
                      - name
                      type: object
                    type: array
                  deploymentName:
                    type: string
                  deploymentOwnerUserName:
                    type: string
                  entrypoint:
                    type: string
                  executor:
                    description: Executors the model 'Executors'
                    type: string
                  gpuEnabled:
                    type: boolean
                  imageRepository:
                    type: string
                  imageTag:
                    type: string
                  inputs:
                    items:
                      description: AlgoInputModel struct for AlgoInputModel
                      properties:
                        contentTypes:
                          items:
                            description: ContentTypeModel struct for ContentTypeModel
                            properties:
                              fileExtension:
                                type: string
                              name:
                                type: string
                              title:
                                type: string
                            type: object
                          type: array
                        description:
                          type: string
                        environmentVariable:
                          type: string
                        httpHeaders:
                          type: string
                        httpPath:
                          type: string
                        httpPort:
                          format: int32
                          type: integer
                        httpVerb:
                          type: string
                        inputDeliveryType:
                          description: InputDeliveryTypes the model 'InputDeliveryTypes'
                          type: string
                        isRequired:
                          type: boolean
                        name:
                          type: string
                        parameter:
                          type: string
                        parameterDelimiter:
                          type: string
                      required:
                      - contentTypes
                      - inputDeliveryType
                      - name
                      type: object
                    type: array
                  livenessInitialDelaySeconds:
                    format: int32
                    type: integer
                  livenessPeriodSeconds:
                    format: int32
                    type: integer
                  livenessTimeoutSeconds:
                    format: int32
                    type: integer
                  outputs:
                    items:
                      description: AlgoOutputModel struct for AlgoOutputModel
                      properties:
                        contentType:
                          description: ContentTypeModel struct for ContentTypeModel
                          properties:
                            fileExtension:
                              type: string
                            name:
                              type: string
                            title:
                              type: string
                          type: object
                        description:
                          type: string
                        name:
                          type: string
                        outputDeliveryType:
                          description: OutputDeliveryTypes the model 'OutputDeliveryTypes'
                          type: string
                        parameter:
                          type: string
                      required:
                      - contentType
                      - name
                      - outputDeliveryType
                      type: object
                    type: array
                  readinessInitialDelaySeconds:
                    format: int32
                    type: integer
                  readinessPeriodSeconds:
                    format: int32
                    type: integer
                  readinessTimeoutSeconds:
                    format: int32
                    type: integer
                  resource:
                    description: ResourceModel struct for ResourceModel
                    properties:
                      autoScale:
                        type: boolean
                      cpuLimitMillicores:
                        format: int64
                        type: integer
                      cpuRequestMillicores:
                        format: int64
                        type: integer
                      gpuLimitMillicores:
                        format: int64
                        type: integer
                      instances:
                        format: int32
                        type: integer
                      maxInstances:
                        format: int32
                        type: integer
                      memoryLimitBytes:
                        format: int64
                        type: integer
                      memoryRequestBytes:
                        format: int64
                        type: integer
                      minInstances:
                        format: int32
                        type: integer
                      scaleMetrics:
                        items:
                          description: ScaleMetricModel struct for ScaleMetricModel
                          properties:
                            averageUtilization:
                              format: int32
                              type: integer
                            averageValue:
                              type: string
                            metricName:
                              type: string
                            metricSelector:
                              type: string
                            objectApiVersion:
                              type: string
                            objectKind:
                              type: string
                            objectName:
                              type: string
                            resourceName:
                              type: string
                            sourceType:
                              description: MetricSourceTypes the model 'MetricSourceTypes'
                              type: string
                            targetType:
                              description: MetricTargetTypes the model 'MetricTargetTypes'
                              type: string
                            value:
                              type: string
                          type: object
                        type: array
                    type: object
                  timeoutSeconds:
                    format: int32
                    type: integer
                  topicConfigs:
                    items:
                      description: TopicConfigModel struct for TopicConfigModel
                      properties:
                        componentType:
                          description: ComponentTypes the model 'ComponentTypes'
                          type: string
                        sourceName:
                          type: string
                        sourceOutputName:
                          type: string
                        topicAutoName:
                          type: boolean
                        topicAutoPartition:
                          type: boolean
                        topicName:
                          type: string
                        topicParams:
                          items:
                            description: TopicParamModel struct for TopicParamModel
                            properties:
                              name:
                                type: string
                              value:
                                type: string
                            type: object
                          type: array
                        topicPartitions:
                          format: int32
                          type: integer
                        topicReplicationFactor:
                          format: int32
                          type: integer
                      required:
                      - sourceName
                      - sourceOutputName
                      type: object
                    type: array
                  writeAllOutputs:
                    type: boolean
                required:
                - algoIndex
                - algoName
                - algoOwnerUserName
                - algoVersionTag
                - deploymentName
                - deploymentOwnerUserName
                - imageRepository
                - imageTag
                type: object
              type: array
            dataConnectors:
              items:
                description: DataConnectorConfig struct for DataConnectorConfig
                properties:
                  connectorClass:
                    type: string
                  dataConnectorType:
                    description: DataConnectorTypes the model 'DataConnectorTypes'
                    type: string
                  deploymentName:
                    type: string
                  imageRepository:
                    type: string
                  imageTag:
                    type: string
                  index:
                    format: int32
                    type: integer
                  name:
                    type: string
                  options:
                    items:
                      description: DataConnectorOptionModel struct for DataConnectorOptionModel
                      properties:
                        dataType:
                          description: DataTypeModel struct for DataTypeModel
                          properties:
                            mask:
                              type: string
                            name:
                              description: DataTypes the model 'DataTypes'
                              type: string
                            precision:
                              format: int32
                              type: integer
                            regex:
                              type: string
                            scale:
                              format: int32
                              type: integer
                          required:
                          - name
                          type: object
                        description:
                          type: string
                        name:
                          type: string
                        required:
                          type: boolean
                        sortOrder:
                          format: int32
                          type: integer
                        value:
                          type: string
                      type: object
                    type: array
                  tasksMax:
                    format: int32
                    type: integer
                  topicConfigs:
                    items:
                      description: TopicConfigModel struct for TopicConfigModel
                      properties:
                        componentType:
                          description: ComponentTypes the model 'ComponentTypes'
                          type: string
                        sourceName:
                          type: string
                        sourceOutputName:
                          type: string
                        topicAutoName:
                          type: boolean
                        topicAutoPartition:
                          type: boolean
                        topicName:
                          type: string
                        topicParams:
                          items:
                            description: TopicParamModel struct for TopicParamModel
                            properties:
                              name:
                                type: string
                              value:
                                type: string
                            type: object
                          type: array
                        topicPartitions:
                          format: int32
                          type: integer
                        topicReplicationFactor:
                          format: int32
                          type: integer
                      required:
                      - sourceName
                      - sourceOutputName
                      type: object
                    type: array
                  versionTag:
                    type: string
                type: object
              type: array
            deploymentName:
              type: string
            deploymentOwnerUserName:
              type: string
            endpoint:
              description: EndpointConfig struct for EndpointConfig
              properties:
                deploymentName:
                  type: string
                deploymentOwnerUserName:
                  type: string
                imageRepository:
                  type: string
                imageTag:
                  type: string
                kafka:
                  description: EndpointKafkaConfig struct for EndpointKafkaConfig
                  properties:
                    brokers:
                      items:
                        type: string
                      type: array
                    params:
                      additionalProperties:
                        type: string
                      type: object
                  type: object
                paths:
                  items:
                    description: EndpointPathModel struct for EndpointPathModel
                    properties:
                      connectionString:
                        type: string
                      contentType:
                        description: ContentTypeModel struct for ContentTypeModel
                        properties:
                          fileExtension:
                            type: string
                          name:
                            type: string
                          title:
                            type: string
                        type: object
                      description:
                        type: string
                      endpointType:
                        description: EndpointTypes the model 'EndpointTypes'
                        type: string
                      isDefault:
                        type: boolean
                      messageDataType:
                        description: MessageDataTypes the model 'MessageDataTypes'
                        type: string
                      name:
                        type: string
                    type: object
                  type: array
                pipelineName:
                  type: string
                pipelineOwnerUserName:
                  type: string
                producer:
                  description: EndpointProducerConfig struct for EndpointProducerConfig
                  properties:
                    cb:
                      description: ProducerCircuitBreaker struct for ProducerCircuitBreaker
                      properties:
                        fails:
                          format: int32
                          type: integer
                        interval:
                          format: int32
                          type: integer
                        requests:
                          format: int32
                          type: integer
                        timeout:
                          type: string
                      type: object
                    resend:
                      description: ProducerResend struct for ProducerResend
                      properties:
                        period:
                          type: string
                        rate_limit:
                          format: int32
                          type: integer
                      type: object
                    wal:
                      description: ProducerWal struct for ProducerWal
                      properties:
                        always_topics:
                          items:
                            type: string
                          type: array
                        disable_topics:
                          items:
                            type: string
                          type: array
                        mode:
                          type: string
                        path:
                          type: string
                        size:
                          type: string
                      type: object
                  type: object
                resource:
                  description: ResourceModel struct for ResourceModel
                  properties:
                    autoScale:
                      type: boolean
                    cpuLimitMillicores:
                      format: int64
                      type: integer
                    cpuRequestMillicores:
                      format: int64
                      type: integer
                    gpuLimitMillicores:
                      format: int64
                      type: integer
                    instances:
                      format: int32
                      type: integer
                    maxInstances:
                      format: int32
                      type: integer
                    memoryLimitBytes:
                      format: int64
                      type: integer
                    memoryRequestBytes:
                      format: int64
                      type: integer
                    minInstances:
                      format: int32
                      type: integer
                    scaleMetrics:
                      items:
                        description: ScaleMetricModel struct for ScaleMetricModel
                        properties:
                          averageUtilization:
                            format: int32
                            type: integer
                          averageValue:
                            type: string
                          metricName:
                            type: string
                          metricSelector:
                            type: string
                          objectApiVersion:
                            type: string
                          objectKind:
                            type: string
                          objectName:
                            type: string
                          resourceName:
                            type: string
                          sourceType:
                            description: MetricSourceTypes the model 'MetricSourceTypes'
                            type: string
                          targetType:
                            description: MetricTargetTypes the model 'MetricTargetTypes'
                            type: string
                          value:
                            type: string
                        type: object
                      type: array
                  type: object
                server:
                  description: EndpointServerConfig struct for EndpointServerConfig
                  properties:
                    grpc:
                      description: EndpointServerListen struct for EndpointServerListen
                      properties:
                        listen:
                          type: string
                      type: object
                    http:
                      description: EndpointServerListen struct for EndpointServerListen
                      properties:
                        listen:
                          type: string
                      type: object
                    monitoring:
                      description: EndpointServerListen struct for EndpointServerListen
                      properties:
                        listen:
                          type: string
                      type: object
                  type: object
                topicConfigs:
                  items:
                    description: TopicConfigModel struct for TopicConfigModel
                    properties:
                      componentType:
                        description: ComponentTypes the model 'ComponentTypes'
                        type: string
                      sourceName:
                        type: string
                      sourceOutputName:
                        type: string
                      topicAutoName:
                        type: boolean
                      topicAutoPartition:
                        type: boolean
                      topicName:
                        type: string
                      topicParams:
                        items:
                          description: TopicParamModel struct for TopicParamModel
                          properties:
                            name:
                              type: string
                            value:
                              type: string
                          type: object
                        type: array
                      topicPartitions:
                        format: int32
                        type: integer
                      topicReplicationFactor:
                        format: int32
                        type: integer
                    required:
                    - sourceName
                    - sourceOutputName
                    type: object
                  type: array
              type: object
            hook:
              description: HookConfig struct for HookConfig
              properties:
                deploymentName:
                  type: string
                deploymentOwnerUserName:
                  type: string
                imageRepository:
                  type: string
                imageTag:
                  type: string
                pipelineName:
                  type: string
                pipelineOwnerUserName:
                  type: string
                pipes:
                  items:
                    description: PipeModel struct for PipeModel
                    properties:
                      destComponentType:
                        description: ComponentTypes the model 'ComponentTypes'
                        type: string
                      destInputName:
                        type: string
                      destName:
                        type: string
                      sourceComponentType:
                        description: ComponentTypes the model 'ComponentTypes'
                        type: string
                      sourceName:
                        type: string
                      sourceOutputMessageDataType:
                        description: MessageDataTypes the model 'MessageDataTypes'
                        type: string
                      sourceOutputName:
                        type: string
                    required:
                    - destInputName
                    - destName
                    - sourceName
                    - sourceOutputName
                    type: object
                  type: array
                resource:
                  description: ResourceModel struct for ResourceModel
                  properties:
                    autoScale:
                      type: boolean
                    cpuLimitMillicores:
                      format: int64
                      type: integer
                    cpuRequestMillicores:
                      format: int64
                      type: integer
                    gpuLimitMillicores:
                      format: int64
                      type: integer
                    instances:
                      format: int32
                      type: integer
                    maxInstances:
                      format: int32
                      type: integer
                    memoryLimitBytes:
                      format: int64
                      type: integer
                    memoryRequestBytes:
                      format: int64
                      type: integer
                    minInstances:
                      format: int32
                      type: integer
                    scaleMetrics:
                      items:
                        description: ScaleMetricModel struct for ScaleMetricModel
                        properties:
                          averageUtilization:
                            format: int32
                            type: integer
                          averageValue:
                            type: string
                          metricName:
                            type: string
                          metricSelector:
                            type: string
                          objectApiVersion:
                            type: string
                          objectKind:
                            type: string
                          objectName:
                            type: string
                          resourceName:
                            type: string
                          sourceType:
                            description: MetricSourceTypes the model 'MetricSourceTypes'
                            type: string
                          targetType:
                            description: MetricTargetTypes the model 'MetricTargetTypes'
                            type: string
                          value:
                            type: string
                        type: object
                      type: array
                  type: object
                topicConfigs:
                  items:
                    description: TopicConfigModel struct for TopicConfigModel
                    properties:
                      componentType:
                        description: ComponentTypes the model 'ComponentTypes'
                        type: string
                      sourceName:
                        type: string
                      sourceOutputName:
                        type: string
                      topicAutoName:
                        type: boolean
                      topicAutoPartition:
                        type: boolean
                      topicName:
                        type: string
                      topicParams:
                        items:
                          description: TopicParamModel struct for TopicParamModel
                          properties:
                            name:
                              type: string
                            value:
                              type: string
                          type: object
                        type: array
                      topicPartitions:
                        format: int32
                        type: integer
                      topicReplicationFactor:
                        format: int32
                        type: integer
                    required:
                    - sourceName
                    - sourceOutputName
                    type: object
                  type: array
                webHooks:
                  items:
                    description: WebHookModel struct for WebHookModel
                    properties:
                      deploymentName:
                        type: string
                      deploymentOwnerUserName:
                        type: string
                      httpHeaders:
                        type: string
                      httpVerb:
                        type: string
                      pipelineHookInputName:
                        type: string
                      webHookUrl:
                        type: string
                    type: object
                  type: array
              required:
              - deploymentName
              - deploymentOwnerUserName
              - pipelineName
              - pipelineOwnerUserName
              type: object
            imagePullPolicy:
              type: string
            kafkaBrokers:
              type: string
            pipelineName:
              type: string
            pipelineOwnerUserName:
              type: string
            pipelineVersionTag:
              type: string
            pipes:
              items:
                description: PipeModel struct for PipeModel
                properties:
                  destComponentType:
                    description: ComponentTypes the model 'ComponentTypes'
                    type: string
                  destInputName:
                    type: string
                  destName:
                    type: string
                  sourceComponentType:
                    description: ComponentTypes the model 'ComponentTypes'
                    type: string
                  sourceName:
                    type: string
                  sourceOutputMessageDataType:
                    description: MessageDataTypes the model 'MessageDataTypes'
                    type: string
                  sourceOutputName:
                    type: string
                required:
                - destInputName
                - destName
                - sourceName
                - sourceOutputName
                type: object
              type: array
            storageBucket:
              type: string
          required:
          - deploymentName
          - deploymentOwnerUserName
          - kafkaBrokers
          - pipelineName
          - pipelineOwnerUserName
          - pipelineVersionTag
          type: object
        status:
          description: PipelineDeploymentStatus defines the observed state of PipelineDeployment
          properties:
            componentStatuses:
              items:
                description: ComponentStatus struct for ComponentStatus
                properties:
                  available:
                    format: int32
                    type: integer
                  componentType:
                    description: ComponentTypes the model 'ComponentTypes'
                    type: string
                  createdTimestamp:
                    type: string
                  current:
                    format: int32
                    type: integer
                  deploymentName:
                    type: string
                  desired:
                    format: int32
                    type: integer
                  index:
                    format: int32
                    type: integer
                  name:
                    type: string
                  ready:
                    format: int32
                    type: integer
                  status:
                    type: string
                  upToDate:
                    format: int32
                    type: integer
                  versionTag:
                    type: string
                type: object
              type: array
            deploymentName:
              type: string
            deploymentOwnerUserName:
              type: string
            podStatuses:
              items:
                description: ComponentPodStatus struct for ComponentPodStatus
                properties:
                  componentType:
                    description: ComponentTypes the model 'ComponentTypes'
                    type: string
                  containerStatuses:
                    items:
                      description: ContainerStatus contains details for the current
                        status of this container.
                      properties:
                        containerID:
                          description: Container's ID in the format 'docker://<container_id>'.
                          type: string
                        image:
                          description: 'The image the container is running. More info:
                            https://kubernetes.io/docs/concepts/containers/images
                            TODO(dchen1107): Which image the container is running
                            with?'
                          type: string
                        imageID:
                          description: ImageID of the container's image.
                          type: string
                        lastState:
                          description: Details about the container's last termination
                            condition.
                          properties:
                            running:
                              description: Details about a running container
                              properties:
                                startedAt:
                                  description: Time at which the container was last
                                    (re-)started
                                  format: date-time
                                  type: string
                              type: object
                            terminated:
                              description: Details about a terminated container
                              properties:
                                containerID:
                                  description: Container's ID in the format 'docker://<container_id>'
                                  type: string
                                exitCode:
                                  description: Exit status from the last termination
                                    of the container
                                  format: int32
                                  type: integer
                                finishedAt:
                                  description: Time at which the container last terminated
                                  format: date-time
                                  type: string
                                message:
                                  description: Message regarding the last termination
                                    of the container
                                  type: string
                                reason:
                                  description: (brief) reason from the last termination
                                    of the container
                                  type: string
                                signal:
                                  description: Signal from the last termination of
                                    the container
                                  format: int32
                                  type: integer
                                startedAt:
                                  description: Time at which previous execution of
                                    the container started
                                  format: date-time
                                  type: string
                              required:
                              - exitCode
                              type: object
                            waiting:
                              description: Details about a waiting container
                              properties:
                                message:
                                  description: Message regarding why the container
                                    is not yet running.
                                  type: string
                                reason:
                                  description: (brief) reason the container is not
                                    yet running.
                                  type: string
                              type: object
                          type: object
                        name:
                          description: This must be a DNS_LABEL. Each container in
                            a pod must have a unique name. Cannot be updated.
                          type: string
                        ready:
                          description: Specifies whether the container has passed
                            its readiness probe.
                          type: boolean
                        restartCount:
                          description: The number of times the container has been
                            restarted, currently based on the number of dead containers
                            that have not yet been removed. Note that this is calculated
                            from dead containers. But those containers are subject
                            to garbage collection. This value will get capped at 5
                            by GC.
                          format: int32
                          type: integer
                        started:
                          description: Specifies whether the container has passed
                            its startup probe. Initialized as false, becomes true
                            after startupProbe is considered successful. Resets to
                            false when the container is restarted, or if kubelet loses
                            state temporarily. Is always true when no startupProbe
                            is defined.
                          type: boolean
                        state:
                          description: Details about the container's current condition.
                          properties:
                            running:
                              description: Details about a running container
                              properties:
                                startedAt:
                                  description: Time at which the container was last
                                    (re-)started
                                  format: date-time
                                  type: string
                              type: object
                            terminated:
                              description: Details about a terminated container
                              properties:
                                containerID:
                                  description: Container's ID in the format 'docker://<container_id>'
                                  type: string
                                exitCode:
                                  description: Exit status from the last termination
                                    of the container
                                  format: int32
                                  type: integer
                                finishedAt:
                                  description: Time at which the container last terminated
                                  format: date-time
                                  type: string
                                message:
                                  description: Message regarding the last termination
                                    of the container
                                  type: string
                                reason:
                                  description: (brief) reason from the last termination
                                    of the container
                                  type: string
                                signal:
                                  description: Signal from the last termination of
                                    the container
                                  format: int32
                                  type: integer
                                startedAt:
                                  description: Time at which previous execution of
                                    the container started
                                  format: date-time
                                  type: string
                              required:
                              - exitCode
                              type: object
                            waiting:
                              description: Details about a waiting container
                              properties:
                                message:
                                  description: Message regarding why the container
                                    is not yet running.
                                  type: string
                                reason:
                                  description: (brief) reason the container is not
                                    yet running.
                                  type: string
                              type: object
                          type: object
                      required:
                      - image
                      - imageID
                      - name
                      - ready
                      - restartCount
                      type: object
                    type: array
                  createdTimestamp:
                    type: string
                  index:
                    format: int32
                    type: integer
                  ip:
                    type: string
                  name:
                    type: string
                  node:
                    type: string
                  podName:
                    type: string
                  restarts:
                    format: int32
                    type: integer
                  status:
                    type: string
                  versionTag:
                    type: string
                type: object
              type: array
            status:
              type: string
          type: object
      type: object
  version: v1beta1
  versions:
  - name: v1beta1
    served: true
    storage: true
